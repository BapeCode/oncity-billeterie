generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "mysql"
  relationMode = "prisma"
}

model Order {
  id          Int           @id @default(autoincrement())
  firstName   String
  lastName    String
  email       String
  phone       String
  createdAt   DateTime      @default(now())
  attendees   String?       @db.Text
  paymentId   Int?          @unique
  accessToken String        @unique
  payment     Payment?      @relation(fields: [paymentId], references: [id])
  participants Participant[]

  @@map("orders") // table r√©elle: orders
}

model Participant {
  id        Int      @id @default(autoincrement())
  firstName String
  lastName  String
  email     String
  offer     String
  orderId   Int
  ticketId  Int?     @unique
  order     Order    @relation(fields: [orderId], references: [id])
  ticket    QRCodeTicket?

  @@index([orderId])
  @@map("participants")
}

model Payment {
  id         Int     @id @default(autoincrement())
  amount     Int
  status     String
  providerId String
  createdAt  DateTime @default(now())
  order      Order?

  @@map("payments")
}

model QRCodeTicket {
  id            Int   @id @default(autoincrement())
  code          String @unique
  used          Boolean @default(false)
  scannedAt     DateTime?
  participantId Int?   @unique
  participant   Participant? @relation(fields: [participantId], references: [id])

  @@map("qrcodetickets")
}